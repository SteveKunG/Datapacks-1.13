# armored elytra
execute as @e[type=item,nbt=!{Item:{tag:{IsArmoredElytra:1b}}},nbt={Item:{id:"minecraft:elytra",Count:1b}}] at @s if entity @e[type=item,nbt={Item:{id:"minecraft:iron_chestplate",Count:1b}},distance=..0.5] if entity @e[type=item,nbt={Item:{id:"minecraft:experience_bottle",Count:5b}},distance=..0.5] if block ~ ~-1 ~ #anvil run function stevekung:combine_elytra_iron
execute as @e[type=item,nbt=!{Item:{tag:{IsArmoredElytra:1b}}},nbt={Item:{id:"minecraft:elytra",Count:1b}}] at @s if entity @e[type=item,nbt={Item:{id:"minecraft:golden_chestplate",Count:1b}},distance=..0.5] if entity @e[type=item,nbt={Item:{id:"minecraft:experience_bottle",Count:5b}},distance=..0.5] if block ~ ~-1 ~ #anvil run function stevekung:combine_elytra_golden
execute as @e[type=item,nbt=!{Item:{tag:{IsArmoredElytra:1b}}},nbt={Item:{id:"minecraft:elytra",Count:1b}}] at @s if entity @e[type=item,nbt={Item:{id:"minecraft:diamond_chestplate",Count:1b}},distance=..0.5] if entity @e[type=item,nbt={Item:{id:"minecraft:experience_bottle",Count:5b}},distance=..0.5] if block ~ ~-1 ~ #anvil run function stevekung:combine_elytra_diamond

# armored elytra enchanted
execute as @e[type=item,nbt={Item:{id:"minecraft:elytra",Count:1b,tag:{IsArmoredElytra:1b,IsIronElytra:1b}}}] at @s if entity @e[type=item,nbt={Item:{id:"minecraft:enchanted_book",tag:{StoredEnchantments:[{id:"minecraft:protection",lvl:4s}]}}},distance=..0.5] if entity @e[type=item,nbt={Item:{id:"minecraft:experience_bottle",Count:10b}},distance=..0.5] run function stevekung:combine_elytra_enchanted_iron
execute as @e[type=item,nbt={Item:{id:"minecraft:elytra",Count:1b,tag:{IsArmoredElytra:1b,IsGoldenElytra:1b}}}] at @s if entity @e[type=item,nbt={Item:{id:"minecraft:enchanted_book",tag:{StoredEnchantments:[{id:"minecraft:protection",lvl:4s}]}}},distance=..0.5] if entity @e[type=item,nbt={Item:{id:"minecraft:experience_bottle",Count:10b}},distance=..0.5] run function stevekung:combine_elytra_enchanted_golden
execute as @e[type=item,nbt={Item:{id:"minecraft:elytra",Count:1b,tag:{IsArmoredElytra:1b,IsDiamondElytra:1b}}}] at @s if entity @e[type=item,nbt={Item:{id:"minecraft:enchanted_book",tag:{StoredEnchantments:[{id:"minecraft:protection",lvl:4s}]}}},distance=..0.5] if entity @e[type=item,nbt={Item:{id:"minecraft:experience_bottle",Count:10b}},distance=..0.5] run function stevekung:combine_elytra_enchanted_diamond